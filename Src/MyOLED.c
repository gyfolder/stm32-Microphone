
#include "MyOLED.h"
#include <math.h>
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include "stm32f1xx_hal.h"

char NumToBigCharStr[16] = {48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 65, 66, 67, 68, 69, 70};
char NumToSmallCharStr[16] = {48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 96, 97, 98, 99, 100, 101};
const unsigned char NumF3x5[][3] ={
  { 0x1f, 0x11, 0x1f},   // 0
  { 0x02, 0x1f, 0x00},   // 1
  { 0x1d, 0x15, 0x17},   // 2
  { 0x15, 0x15, 0x1f},   // 3
  { 0x07, 0x04, 0x1f},   // 4
  { 0x17, 0x15, 0x1d},   // 5
  { 0x1f, 0x15, 0x1d},   // 6
  { 0x03, 0x01, 0x1f},   // 7
  { 0x1f, 0x15, 0x1f},   // 8
  { 0x17, 0x15, 0x1f},   // 9
  { 0x1f, 0x05, 0x1f},   // A
  { 0x1f, 0x15, 0x1e},   // B
  { 0x1f, 0x11, 0x11},   // C
  { 0x1f, 0x11, 0x0e},   // D
  { 0x1f, 0x15, 0x15},   // E
  { 0x1f, 0x05, 0x05},   // F
};

const unsigned char F6x8[][6] ={
  { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp
  { 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !
  { 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "
  { 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #
  { 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $
  { 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %
  { 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &
  { 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '
  { 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (
  { 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )
  { 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *
  { 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +
  { 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,
  { 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -
  { 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .
  { 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /
  { 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0
  { 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1
  { 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2
  { 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3
  { 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4
  { 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5
  { 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6
  { 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7
  { 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8
  { 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9
  { 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :
  { 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;
  { 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <
  { 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =
  { 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >
  { 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?
  { 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @
  { 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A
  { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B
  { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C
  { 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D
  { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E
  { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F
  { 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G
  { 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H
  { 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I
  { 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J
  { 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K
  { 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L
  { 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M
  { 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N
  { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O
  { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P
  { 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q
  { 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R
  { 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S
  { 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T
  { 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U
  { 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V
  { 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W
  { 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X
  { 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y
  { 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z
  { 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [ 91
  { 0x00, 0x02, 0x04 , 0x08, 0x10, 0x20 },   // \92
  { 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]
  { 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^
  { 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _
  { 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '
  { 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a
  { 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b
  { 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c
  { 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d
  { 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e
  { 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f
  { 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g
  { 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h
  { 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i
  { 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j
  { 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k
  { 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l
  { 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m
  { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n
  { 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o
  { 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p
  { 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q
  { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r
  { 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s
  { 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t
  { 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u
  { 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v
  { 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w
  { 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x
  { 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y
  { 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z
  { 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }    // horiz lines
};



const unsigned char F8X16[] ={
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // 0
  0x00, 0x00, 0x00, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x33, 0x30, 0x00, 0x00, 0x00, //!1
  0x00, 0x10, 0x0C, 0x06, 0x10, 0x0C, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //"2
  0x40, 0xC0, 0x78, 0x40, 0xC0, 0x78, 0x40, 0x00, 0x04, 0x3F, 0x04, 0x04, 0x3F, 0x04, 0x04, 0x00, //#3
  0x00, 0x70, 0x88, 0xFC, 0x08, 0x30, 0x00, 0x00, 0x00, 0x18, 0x20, 0xFF, 0x21, 0x1E, 0x00, 0x00, //$4
  0xF0, 0x08, 0xF0, 0x00, 0xE0, 0x18, 0x00, 0x00, 0x00, 0x21, 0x1C, 0x03, 0x1E, 0x21, 0x1E, 0x00, //%5
  0x00, 0xF0, 0x08, 0x88, 0x70, 0x00, 0x00, 0x00, 0x1E, 0x21, 0x23, 0x24, 0x19, 0x27, 0x21, 0x10, //&6
  0x10, 0x16, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //'7
  0x00, 0x00, 0x00, 0xE0, 0x18, 0x04, 0x02, 0x00, 0x00, 0x00, 0x00, 0x07, 0x18, 0x20, 0x40, 0x00, //(8
  0x00, 0x02, 0x04, 0x18, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x40, 0x20, 0x18, 0x07, 0x00, 0x00, 0x00, //)9
  0x40, 0x40, 0x80, 0xF0, 0x80, 0x40, 0x40, 0x00, 0x02, 0x02, 0x01, 0x0F, 0x01, 0x02, 0x02, 0x00, // *10
  0x00, 0x00, 0x00, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x1F, 0x01, 0x01, 0x01, 0x00, //+11
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xB0, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, //,12
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, //-13
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, //.14
  0x00, 0x00, 0x00, 0x00, 0x80, 0x60, 0x18, 0x04, 0x00, 0x60, 0x18, 0x06, 0x01, 0x00, 0x00, 0x00, ///15
  0x00, 0xE0, 0x10, 0x08, 0x08, 0x10, 0xE0, 0x00, 0x00, 0x0F, 0x10, 0x20, 0x20, 0x10, 0x0F, 0x00, //016
  0x00, 0x10, 0x10, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x20, 0x3F, 0x20, 0x20, 0x00, 0x00, //117
  0x00, 0x70, 0x08, 0x08, 0x08, 0x88, 0x70, 0x00, 0x00, 0x30, 0x28, 0x24, 0x22, 0x21, 0x30, 0x00, //218
  0x00, 0x30, 0x08, 0x88, 0x88, 0x48, 0x30, 0x00, 0x00, 0x18, 0x20, 0x20, 0x20, 0x11, 0x0E, 0x00, //319
  0x00, 0x00, 0xC0, 0x20, 0x10, 0xF8, 0x00, 0x00, 0x00, 0x07, 0x04, 0x24, 0x24, 0x3F, 0x24, 0x00, //420
  0x00, 0xF8, 0x08, 0x88, 0x88, 0x08, 0x08, 0x00, 0x00, 0x19, 0x21, 0x20, 0x20, 0x11, 0x0E, 0x00, //521
  0x00, 0xE0, 0x10, 0x88, 0x88, 0x18, 0x00, 0x00, 0x00, 0x0F, 0x11, 0x20, 0x20, 0x11, 0x0E, 0x00, //622
  0x00, 0x38, 0x08, 0x08, 0xC8, 0x38, 0x08, 0x00, 0x00, 0x00, 0x00, 0x3F, 0x00, 0x00, 0x00, 0x00, //723
  0x00, 0x70, 0x88, 0x08, 0x08, 0x88, 0x70, 0x00, 0x00, 0x1C, 0x22, 0x21, 0x21, 0x22, 0x1C, 0x00, //824
  0x00, 0xE0, 0x10, 0x08, 0x08, 0x10, 0xE0, 0x00, 0x00, 0x00, 0x31, 0x22, 0x22, 0x11, 0x0F, 0x00, //925
  0x00, 0x00, 0x00, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, 0x00, 0x00, 0x00, //:26
  0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x60, 0x00, 0x00, 0x00, 0x00, //;27
  0x00, 0x00, 0x80, 0x40, 0x20, 0x10, 0x08, 0x00, 0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x00, //<28
  0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, //=29
  0x00, 0x08, 0x10, 0x20, 0x40, 0x80, 0x00, 0x00, 0x00, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01, 0x00, //>30
  0x00, 0x70, 0x48, 0x08, 0x08, 0x08, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x30, 0x36, 0x01, 0x00, 0x00, //?31
  0xC0, 0x30, 0xC8, 0x28, 0xE8, 0x10, 0xE0, 0x00, 0x07, 0x18, 0x27, 0x24, 0x23, 0x14, 0x0B, 0x00, //@32
  0x00, 0x00, 0xC0, 0x38, 0xE0, 0x00, 0x00, 0x00, 0x20, 0x3C, 0x23, 0x02, 0x02, 0x27, 0x38, 0x20, //A33
  0x08, 0xF8, 0x88, 0x88, 0x88, 0x70, 0x00, 0x00, 0x20, 0x3F, 0x20, 0x20, 0x20, 0x11, 0x0E, 0x00, //B34
  0xC0, 0x30, 0x08, 0x08, 0x08, 0x08, 0x38, 0x00, 0x07, 0x18, 0x20, 0x20, 0x20, 0x10, 0x08, 0x00, //C35
  0x08, 0xF8, 0x08, 0x08, 0x08, 0x10, 0xE0, 0x00, 0x20, 0x3F, 0x20, 0x20, 0x20, 0x10, 0x0F, 0x00, //D36
  0x08, 0xF8, 0x88, 0x88, 0xE8, 0x08, 0x10, 0x00, 0x20, 0x3F, 0x20, 0x20, 0x23, 0x20, 0x18, 0x00, //E37
  0x08, 0xF8, 0x88, 0x88, 0xE8, 0x08, 0x10, 0x00, 0x20, 0x3F, 0x20, 0x00, 0x03, 0x00, 0x00, 0x00, //F38
  0xC0, 0x30, 0x08, 0x08, 0x08, 0x38, 0x00, 0x00, 0x07, 0x18, 0x20, 0x20, 0x22, 0x1E, 0x02, 0x00, //G39
  0x08, 0xF8, 0x08, 0x00, 0x00, 0x08, 0xF8, 0x08, 0x20, 0x3F, 0x21, 0x01, 0x01, 0x21, 0x3F, 0x20, //H40
  0x00, 0x08, 0x08, 0xF8, 0x08, 0x08, 0x00, 0x00, 0x00, 0x20, 0x20, 0x3F, 0x20, 0x20, 0x00, 0x00, //I41
  0x00, 0x00, 0x08, 0x08, 0xF8, 0x08, 0x08, 0x00, 0xC0, 0x80, 0x80, 0x80, 0x7F, 0x00, 0x00, 0x00, //J42
  0x08, 0xF8, 0x88, 0xC0, 0x28, 0x18, 0x08, 0x00, 0x20, 0x3F, 0x20, 0x01, 0x26, 0x38, 0x20, 0x00, //K43
  0x08, 0xF8, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x3F, 0x20, 0x20, 0x20, 0x20, 0x30, 0x00, //L44
  0x08, 0xF8, 0xF8, 0x00, 0xF8, 0xF8, 0x08, 0x00, 0x20, 0x3F, 0x00, 0x3F, 0x00, 0x3F, 0x20, 0x00, //M45
  0x08, 0xF8, 0x30, 0xC0, 0x00, 0x08, 0xF8, 0x08, 0x20, 0x3F, 0x20, 0x00, 0x07, 0x18, 0x3F, 0x00, //N46
  0xE0, 0x10, 0x08, 0x08, 0x08, 0x10, 0xE0, 0x00, 0x0F, 0x10, 0x20, 0x20, 0x20, 0x10, 0x0F, 0x00, //O47
  0x08, 0xF8, 0x08, 0x08, 0x08, 0x08, 0xF0, 0x00, 0x20, 0x3F, 0x21, 0x01, 0x01, 0x01, 0x00, 0x00, //P48
  0xE0, 0x10, 0x08, 0x08, 0x08, 0x10, 0xE0, 0x00, 0x0F, 0x18, 0x24, 0x24, 0x38, 0x50, 0x4F, 0x00, //Q49
  0x08, 0xF8, 0x88, 0x88, 0x88, 0x88, 0x70, 0x00, 0x20, 0x3F, 0x20, 0x00, 0x03, 0x0C, 0x30, 0x20, //R50
  0x00, 0x70, 0x88, 0x08, 0x08, 0x08, 0x38, 0x00, 0x00, 0x38, 0x20, 0x21, 0x21, 0x22, 0x1C, 0x00, //S51
  0x18, 0x08, 0x08, 0xF8, 0x08, 0x08, 0x18, 0x00, 0x00, 0x00, 0x20, 0x3F, 0x20, 0x00, 0x00, 0x00, //T52
  0x08, 0xF8, 0x08, 0x00, 0x00, 0x08, 0xF8, 0x08, 0x00, 0x1F, 0x20, 0x20, 0x20, 0x20, 0x1F, 0x00, //U53
  0x08, 0x78, 0x88, 0x00, 0x00, 0xC8, 0x38, 0x08, 0x00, 0x00, 0x07, 0x38, 0x0E, 0x01, 0x00, 0x00, //V54
  0xF8, 0x08, 0x00, 0xF8, 0x00, 0x08, 0xF8, 0x00, 0x03, 0x3C, 0x07, 0x00, 0x07, 0x3C, 0x03, 0x00, //W55
  0x08, 0x18, 0x68, 0x80, 0x80, 0x68, 0x18, 0x08, 0x20, 0x30, 0x2C, 0x03, 0x03, 0x2C, 0x30, 0x20, //X56
  0x08, 0x38, 0xC8, 0x00, 0xC8, 0x38, 0x08, 0x00, 0x00, 0x00, 0x20, 0x3F, 0x20, 0x00, 0x00, 0x00, //Y57
  0x10, 0x08, 0x08, 0x08, 0xC8, 0x38, 0x08, 0x00, 0x20, 0x38, 0x26, 0x21, 0x20, 0x20, 0x18, 0x00, //Z58
  0x00, 0x00, 0x00, 0xFE, 0x02, 0x02, 0x02, 0x00, 0x00, 0x00, 0x00, 0x7F, 0x40, 0x40, 0x40, 0x00, //[59
  0x00, 0x0C, 0x30, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x06, 0x38, 0xC0, 0x00, //\60
  0x00, 0x02, 0x02, 0x02, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x40, 0x40, 0x40, 0x7F, 0x00, 0x00, 0x00, //]61
  0x00, 0x00, 0x04, 0x02, 0x02, 0x02, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //^62
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, //_63
  0x00, 0x02, 0x02, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //`64
  0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x19, 0x24, 0x22, 0x22, 0x22, 0x3F, 0x20, //a65
  0x08, 0xF8, 0x00, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x3F, 0x11, 0x20, 0x20, 0x11, 0x0E, 0x00, //b66
  0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x0E, 0x11, 0x20, 0x20, 0x20, 0x11, 0x00, //c67
  0x00, 0x00, 0x00, 0x80, 0x80, 0x88, 0xF8, 0x00, 0x00, 0x0E, 0x11, 0x20, 0x20, 0x10, 0x3F, 0x20, //d68
  0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x1F, 0x22, 0x22, 0x22, 0x22, 0x13, 0x00, //e69
  0x00, 0x80, 0x80, 0xF0, 0x88, 0x88, 0x88, 0x18, 0x00, 0x20, 0x20, 0x3F, 0x20, 0x20, 0x00, 0x00, //f70
  0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x6B, 0x94, 0x94, 0x94, 0x93, 0x60, 0x00, //g71
  0x08, 0xF8, 0x00, 0x80, 0x80, 0x80, 0x00, 0x00, 0x20, 0x3F, 0x21, 0x00, 0x00, 0x20, 0x3F, 0x20, //h72
  0x00, 0x80, 0x98, 0x98, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x20, 0x3F, 0x20, 0x20, 0x00, 0x00, //i73
  0x00, 0x00, 0x00, 0x80, 0x98, 0x98, 0x00, 0x00, 0x00, 0xC0, 0x80, 0x80, 0x80, 0x7F, 0x00, 0x00, //j74
  0x08, 0xF8, 0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0x20, 0x3F, 0x24, 0x02, 0x2D, 0x30, 0x20, 0x00, //k75
  0x00, 0x08, 0x08, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x20, 0x3F, 0x20, 0x20, 0x00, 0x00, //l76
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x20, 0x3F, 0x20, 0x00, 0x3F, 0x20, 0x00, 0x3F, //m77
  0x80, 0x80, 0x00, 0x80, 0x80, 0x80, 0x00, 0x00, 0x20, 0x3F, 0x21, 0x00, 0x00, 0x20, 0x3F, 0x20, //n78
  0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x1F, 0x20, 0x20, 0x20, 0x20, 0x1F, 0x00, //o79
  0x80, 0x80, 0x00, 0x80, 0x80, 0x00, 0x00, 0x00, 0x80, 0xFF, 0xA1, 0x20, 0x20, 0x11, 0x0E, 0x00, //p80
  0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x0E, 0x11, 0x20, 0x20, 0xA0, 0xFF, 0x80, //q81
  0x80, 0x80, 0x80, 0x00, 0x80, 0x80, 0x80, 0x00, 0x20, 0x20, 0x3F, 0x21, 0x20, 0x00, 0x01, 0x00, //r82
  0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x33, 0x24, 0x24, 0x24, 0x24, 0x19, 0x00, //s83
  0x00, 0x80, 0x80, 0xE0, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x20, 0x20, 0x00, 0x00, //t84
  0x80, 0x80, 0x00, 0x00, 0x00, 0x80, 0x80, 0x00, 0x00, 0x1F, 0x20, 0x20, 0x20, 0x10, 0x3F, 0x20, //u85
  0x80, 0x80, 0x80, 0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0x01, 0x0E, 0x30, 0x08, 0x06, 0x01, 0x00, //v86
  0x80, 0x80, 0x00, 0x80, 0x00, 0x80, 0x80, 0x80, 0x0F, 0x30, 0x0C, 0x03, 0x0C, 0x30, 0x0F, 0x00, //w87
  0x00, 0x80, 0x80, 0x00, 0x80, 0x80, 0x80, 0x00, 0x00, 0x20, 0x31, 0x2E, 0x0E, 0x31, 0x20, 0x00, //x88
  0x80, 0x80, 0x80, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x81, 0x8E, 0x70, 0x18, 0x06, 0x01, 0x00, //y89
  0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x21, 0x30, 0x2C, 0x22, 0x21, 0x30, 0x00, //z90
  0x00, 0x00, 0x00, 0x00, 0x80, 0x7C, 0x02, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3F, 0x40, 0x40, //{91
  0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, //|92
  0x00, 0x02, 0x02, 0x7C, 0x80, 0x00, 0x00, 0x00, 0x00, 0x40, 0x40, 0x3F, 0x00, 0x00, 0x00, 0x00, //}93
  0x00, 0x06, 0x01, 0x01, 0x02, 0x02, 0x04, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //~94
	
};






GPIO_TypeDef *resgpio = 0,*ssgpio = 0,*dcgpio = 0;
unsigned char respin = 0,sspin = 0,dcpin = 0;
unsigned char Dot_Data[132][8];//OLED.

__weak void OLED_SPI_Transmit(unsigned char *pData, uint16_t Size, uint32_t Timeout);


void SetRESPin(void* gpio, unsigned char pin){resgpio = (GPIO_TypeDef*)gpio;respin = pin;}
void SetDCPin(void* gpio, unsigned char pin){dcgpio = (GPIO_TypeDef*)gpio;dcpin = pin;}
void SetSSPin(void* gpio, unsigned char pin){ssgpio = (GPIO_TypeDef*)gpio;sspin = pin;}
void Setpinstate(int _0res_1dc_2ss,char set){
	if(_0res_1dc_2ss==0){
		resgpio->BSRR = ((set==0)<<(respin+16))|((set==1)<<respin);
	}else if(_0res_1dc_2ss==1){
		dcgpio->BSRR = ((set==0)<<(dcpin+16))|((set==1)<<dcpin);
	}else if(_0res_1dc_2ss==2){
		ssgpio->BSRR = ((set==0)<<(sspin+16))|((set==1)<<sspin);
	}
}
void sendSPI(unsigned char Indata, unsigned char DC){
	Setpinstate(1,DC);//if(DC)GPIOA->BSRR=0x00000040;else GPIOA->BSRR=0x00400000;	//DC
	Setpinstate(2,0);//GPIOA->BSRR=0x00100000;//SS
	OLED_SPI_Transmit((unsigned char*)(&Indata),1,100);
	//SPI.transfer(Indata); //Send the HEX data over SPI-1 port and store the received byte to the <data> variable.
	Setpinstate(2,1);//GPIOA->BSRR=0x00000010;//SS
}
void send2SPI(unsigned char Indata1, unsigned char Indata2, unsigned char DC){
	Setpinstate(1,DC);//if(DC)GPIOA->BSRR=0x00000040;else GPIOA->BSRR=0x00400000;	//DC
	Setpinstate(2,0);//GPIOA->BSRR=0x00100000;//SS
	OLED_SPI_Transmit((unsigned char*)(&Indata1),1,100);
	OLED_SPI_Transmit((unsigned char*)(&Indata2),1,100);
	Setpinstate(2,1);//GPIOA->BSRR=0x00000010;//SS
}
void ShowBuffer(){
	sendSPI(0x40 + 0, OLED_Comm); // Set  Display Start Line(SY)
	for (int ay = 0; ay < 8; ay++)
	{
		sendSPI(0xB8 + ay, OLED_Comm); // Set   Page Address Line(Y)
		for (int ax = 0; ax < 132; ax++)
		{
			sendSPI(Dot_Data[ax][ay], OLED_Data); //  Write  Display Data
		}
	}
	sendSPI(0x40 + 0, OLED_Comm); // Set  Display Start Line(SY)
}
void ClearBuffer(unsigned char DC){
	int a = DC * 0xFF;
	for (int ax = 0; ax < 132; ax++)
	{
		for (int ay = 0; ay < 8; ay++)
		{
			Dot_Data[ax][ay] = a;
		}
	}
}



void OLEDinit(){
	for(int sdasdwe=0;sdasdwe<132;sdasdwe++)for(int sdasdwe1=0;sdasdwe1<8;sdasdwe1++)Dot_Data[sdasdwe][sdasdwe1] = 0;
	
	Setpinstate(0,0);//resgpio->BSRR=1<<(respin+16);//RES
	HAL_Delay(50);
	Setpinstate(0,1);//resgpio->BSRR=1<<respin;


	sendSPI(0xC8, OLED_Comm);
	sendSPI(0xA1, OLED_Comm);
	send2SPI(0xA8, 0x3f, OLED_Comm);
	send2SPI(0xD9, 0x0F, OLED_Comm); //  Dis-charge/Pre-charge Period Mode/Data Set  // F0 B3 77 3B 0F
	send2SPI(0xD5, 0x80, OLED_Comm); // Divide Ratio/Oscillator Frequency Mode/Data Set
	sendSPI(0xAF, OLED_Comm); // Display ON
	ClearBuffer(0);
	ShowBuffer();
};
int CharToNum(char inchar){
	if (inchar >= '0' && inchar <= '9')return inchar - 48;
	if (inchar >= 'A' && inchar <= 'F')return inchar - 65;
	if (inchar >= 'a' && inchar <= 'f')return inchar - 97;
	return -1;
}
void ShowDrawDot(unsigned char x, unsigned char y, unsigned char OnOff){
	x = x + 1;
	if (y < 64 && x < 132)
	{
		if(OnOff)Dot_Data[x][y/8] |= (1 << (y%8));
		else Dot_Data[x][y/8] &= ~(1 << (y%8));
		sendSPI(0x40 + 0, OLED_Comm);
		sendSPI(0xB8 + y/8, OLED_Comm);
		sendSPI(OnOff << (y%8), OLED_Data);
	}
}
void ShowDrawChar(unsigned char x, unsigned char y, char Fonts, char charater){
	charater &= 0x7f;
	unsigned char WrData;
	if (Fonts == OLED_Char6X8) {
		if (y < 57 && x < 124 && charater > 31)
		{
			for (int ax = 0; ax < 6; ax++)
			{
				WrData = F6x8[charater - 32][ax];
				for (int ay = 0; ay < 8; ay++)
				{
					ShowDrawDot(x + ax, y + ay, WrData & (1 << ay));
				}
			}
		}
		} else if (Fonts == OLED_Char8X16) {
		if (y < 49 && x < 122 && charater > 31)
		{
			for (int ax = 0; ax < 16; ax++)
			{
				WrData = F8X16[(charater - 32) * 16 + ax];
				for (int ay = 0; ay < 8; ay++)
				{
					ShowDrawDot(x + (ax % 8), y + ay + (int)(ax / 8) * 8, WrData & (1 << ay));
				}
			}
		}
	}
}
void ShowDrawString(unsigned char x, unsigned char y, char Fonts, char* Strings){
	for (int a = 0; Strings[a]; a++)
	{
		ShowDrawChar(x, y, Fonts, Strings[a]);
		if (Fonts == OLED_Char6X8)x += 6;
		if (Fonts == OLED_Char8X16)x += 8;
	}
}
void NoShowDrawDot(unsigned char x, unsigned char y, unsigned char OnOff){
	x = x + 1;
	if (y < 64 && x < 132)
	{
		if(OnOff)Dot_Data[x][y/8] |= (1 << (y%8));
		else Dot_Data[x][y/8] &= ~(1 << (y%8));
	}
}
void NoShowDrawLine(unsigned char x0, unsigned char y0, unsigned char x1, unsigned char y1, unsigned char OnOff){
	int dx = abs(x1 - x0), sx = x0 < x1 ? 1 : -1;
	int dy = abs(y1 - y0), sy = y0 < y1 ? 1 : -1;
	int err = (dx > dy ? dx : -dy) / 2, e2;

	while (1)
	{
		NoShowDrawDot(x0, y0, OnOff);
		if (x0 == x1 && y0 == y1)
		break;
		e2 = err;
		if (e2 > -dx)
		{
			err -= dy;
			x0 += sx;
		}
		if (e2 < dy)
		{
			err += dx;
			y0 += sy;
		}
	}
}
void NoShowDrawNum(unsigned char x, unsigned char y, char Fonts, int Num, int EngTrueBigFalseSmall){
	unsigned char WrData = 0;
	if (Fonts == OLED_Char6X8) {
		if (y < 57 && x < 124 && Num < 16)
		{
			for (int ax = 0; ax < 6; ax++)
			{
				if (EngTrueBigFalseSmall == 1)WrData = F6x8[NumToBigCharStr[Num] - 32][ax];
				else if (EngTrueBigFalseSmall == 0)WrData = F6x8[NumToSmallCharStr[Num] - 32][ax];
				for (int ay = 0; ay < 8; ay++)
				{
					NoShowDrawDot(x + ax, y + ay, WrData & (1 << ay));
				}
			}
		}
		} else if (Fonts == OLED_Char8X16) {
		if (y < 49 && x < 122 && Num < 16)
		{
			for (int ax = 0; ax < 16; ax++)
			{
				if (EngTrueBigFalseSmall == 1)WrData = F8X16[(NumToBigCharStr[Num] - 32) * 16 + ax];
				else if (EngTrueBigFalseSmall == 0)WrData = F8X16[(NumToSmallCharStr[Num] - 32) * 16 + ax];
				for (int ay = 0; ay < 8; ay++)
				{
					NoShowDrawDot(x + (ax % 8), y + ay + (int)(ax / 8) * 8, WrData & (1 << ay));
				}
			}
		}
		} else if (Fonts == OLED_Num3X5) {
		if (y < 59 && x < 127 && Num < 16)
		{
			for (int ax = 0; ax < 3; ax++)
			{
				WrData = NumF3x5[Num][ax];
				for (int ay = 0; ay < 5; ay++)
				{
					NoShowDrawDot(x + ax, y + ay, WrData & (1 << ay));
				}
			}
		}
	}
}
void NoShowDrawNum1(unsigned char x, unsigned char y, char Fonts, int Num, unsigned char OnOff, int EngTrueBigFalseSmall){
	unsigned char WrData = 0;
	if (Fonts == OLED_Char6X8) {
		if (y < 57 && x < 124 && Num < 16)
		{
			for (int ax = 0; ax < 6; ax++)
			{
				if (EngTrueBigFalseSmall == 1)WrData = F6x8[NumToBigCharStr[Num] - 32][ax];
				else if (EngTrueBigFalseSmall == 0)WrData = F6x8[NumToSmallCharStr[Num] - 32][ax];
				for (int ay = 0; ay < 8; ay++)
				{
					if (OnOff)NoShowDrawDot(x + ax, y + ay, WrData & (1 << ay));
					else NoShowDrawDot(x + ax, y + ay, !(WrData & (1 << ay)));
				}
			}
		}
		} else if (Fonts == OLED_Char8X16) {
		if (y < 49 && x < 122 && Num < 16)
		{
			for (int ax = 0; ax < 16; ax++)
			{
				if (EngTrueBigFalseSmall == 1)WrData = F8X16[(NumToBigCharStr[Num] - 32) * 16 + ax];
				else if (EngTrueBigFalseSmall == 0)WrData = F8X16[(NumToSmallCharStr[Num] - 32) * 16 + ax];
				for (int ay = 0; ay < 8; ay++)
				{
					if (OnOff)NoShowDrawDot(x + (ax % 8), y + ay + (int)(ax / 8) * 8, WrData & (1 << ay));
					else NoShowDrawDot(x + (ax % 8), y + ay + (int)(ax / 8) * 8, !(WrData & (1 << ay)));
				}
			}
		}
		} else if (Fonts == OLED_Num3X5) {
		if (y < 59 && x < 127 && Num < 16)
		{
			for (int ax = 0; ax < 3; ax++)
			{
				WrData = NumF3x5[Num][ax];
				for (int ay = 0; ay < 5; ay++)
				{
					if (OnOff)NoShowDrawDot(x + ax, y + ay, WrData & (1 << ay));
					else NoShowDrawDot(x + ax, y + ay, !(WrData & (1 << ay)));
				}
			}
		}
	}
}
void NoShowDrawChar(unsigned char x, unsigned char y, char Fonts, char charater){
	charater &= 0x7f;
	unsigned char WrData;
	if (Fonts == OLED_Char6X8) {
		if (y < 57 && x < 124 && charater > 31)
		{
			for (int ax = 0; ax < 6; ax++)
			{
				WrData = F6x8[charater - 32][ax];
				for (int ay = 0; ay < 8; ay++)
				{
					NoShowDrawDot(x + ax, y + ay, WrData & (1 << ay));
				}
			}
		}
		} else if (Fonts == OLED_Char8X16) {
		if (y < 49 && x < 122 && charater > 31)
		{
			for (int ax = 0; ax < 16; ax++)
			{
				WrData = F8X16[(charater - 32) * 16 + ax];
				for (int ay = 0; ay < 8; ay++)
				{
					NoShowDrawDot(x + (ax % 8), y + ay + (int)(ax / 8) * 8, WrData & (1 << ay));
				}
			}
		}
	}
}
void NoShowDrawChar1(unsigned char x, unsigned char y, char Fonts, char charater, unsigned char OnOff){
	charater &= 0x7f;
	unsigned char WrData;
	if (Fonts == OLED_Char6X8) {
		if (y < 57 && x < 124 && charater > 31)
		{
			for (int ax = 0; ax < 6; ax++)
			{
				WrData = F6x8[charater - 32][ax];
				for (int ay = 0; ay < 8; ay++)
				{
					if (OnOff)NoShowDrawDot(x + ax, y + ay, WrData & (1 << ay));
					else NoShowDrawDot(x + ax, y + ay, !(WrData & (1 << ay)));
				}
			}
		}
		} else if (Fonts == OLED_Char8X16) {
		if (y < 49 && x < 122 && charater > 31)
		{
			for (int ax = 0; ax < 16; ax++)
			{
				WrData = F8X16[(charater - 32) * 16 + ax];
				for (int ay = 0; ay < 8; ay++)
				{
					if (OnOff)NoShowDrawDot(x + (ax % 8), y + ay + (int)(ax / 8) * 8, WrData & (1 << ay));
					else NoShowDrawDot(x + (ax % 8), y + ay + (int)(ax / 8) * 8, !(WrData & (1 << ay)));
				}
			}
		}
	}
}
void NoShowDrawString(unsigned char x, unsigned char y, char Fonts, char* Strings){
	for (int a = 0; Strings[a]; a++)
	{
		NoShowDrawChar(x, y, Fonts, Strings[a]);
		if (Fonts == OLED_Char6X8)x += 6;
		if (Fonts == OLED_Char8X16)x += 8;
	}
}
void NoShowDrawString1(unsigned char x, unsigned char y, char Fonts, char* Strings, unsigned char OnOff){
	for (int a = 0; Strings[a]; a++)
	{
		NoShowDrawChar1(x, y, Fonts, Strings[a], OnOff);
		if (Fonts == OLED_Char6X8)x += 6;
		if (Fonts == OLED_Char8X16)x += 8;
	}
}
void NoShowDrawArea(unsigned char x, unsigned char y, unsigned char x1, unsigned char y1, unsigned char OnOff){
	for (int b = 0; b < (y1 - y); b++)
	{
		for (int a = 0; a < (x1 - x); a++)
		{
			NoShowDrawDot(x + a, y + b, OnOff);
		}
	}
}
void NoShowDrawAreaW(unsigned char x, unsigned char y, unsigned char w, unsigned char h, unsigned char OnOff){
	for (int b = 0; b < w; b++)
	{
		for (int a = 0; a < h; a++)
		{
			NoShowDrawDot(x + a, y + b, OnOff);
		}
	}
}

void NoShowDrawNumStr(unsigned char x, unsigned char y, char Fonts, char* Strings, int EngTrueBigFalseSmall){
	int b = 0;
	if (Fonts == OLED_Num3X5){NoShowDrawAreaW(x-1,y-1,7,strlen(Strings)*4+1,0);b = 4;}
	if (Fonts == OLED_Char6X8)b = 6;
	if (Fonts == OLED_Char8X16)b = 8;
	for (int a = 0; Strings[a]; a++)
	{
		NoShowDrawNum(x + b * a, y, Fonts, CharToNum(Strings[a]),EngTrueBigFalseSmall);
	}
}
void NoShowDrawNumStr1(unsigned char x, unsigned char y, char Fonts, char* Strings, unsigned char OnOff, int EngTrueBigFalseSmall){
	int b = 0;
	if (Fonts == OLED_Num3X5){NoShowDrawAreaW(x-1,y-1,7,strlen(Strings)*4+1,!OnOff);b = 4;}
	if (Fonts == OLED_Char6X8)b = 6;
	if (Fonts == OLED_Char8X16)b = 8;
	for (int a = 0; Strings[a]; a++)
	{
		NoShowDrawNum1(x + b * a, y, Fonts, CharToNum(Strings[a]),OnOff,EngTrueBigFalseSmall);
	}
}
void NoShowDrawCircle(unsigned char x, unsigned char y, unsigned char r, unsigned char OnOff, unsigned char Full){
	int b = 0;
	if (Full) {
		for (int a = -r; a < r; a++)
		{
			b = sqrt((r * r) - (a * a));
			NoShowDrawLine( x + a, y - b,  x + a, y + b, OnOff);
		}
	} else
	{
		int c = 0;
		for (int a = -r; a < r; a++)
		{
			b = sqrt((r * r) - (a * a));
			c = sqrt((r * r) - ((a - 1) * (a - 1)));
			NoShowDrawLine( x + a, y + c, x + a, y + b, OnOff);
			NoShowDrawLine( x + a, y - c, x + a, y - b, OnOff);
		}
	}
}
void NoShowDrawPicture(unsigned char x, unsigned char y, unsigned char w, unsigned char h, unsigned char* Picture, unsigned char OnOff){
	if(OnOff){
		for (int b = 0; b < h; b++) {
			for (int a = 0; a < w; a++) {
				NoShowDrawDot(x + a	, y + b, Picture[b*(((w-1)/8)+1) + a/8] & (1 << (7 - a%8)));
			}
		}
	}
	else {
		for (int b = 0; b < h; b++) {
			for (int a = 0; a < w; a++) {
				NoShowDrawDot(x + a	, y + b, !(Picture[b*(((w-1)/8)+1) + a/8] & (1 << (7 - a%8))));
			}
		}
	}
}
